You are an expert cybersecurity full-stack developer. I want you to generate a complete OT (Operational Technology) Attack Simulation & Mitigation System with the following specifications. The system must be modular, production-scalable, and company-deployable. Use clean, secure, and well-commented code. Generate file-wise code in blocks.

---

### âœ… OVERVIEW

Build a full-stack system to simulate cyberattacks on OT protocols (Modbus, MQTT, OPC-UA), detect them in real-time using Suricata IDS, monitor machinery behavior using PLC/sensor data, and suggest mitigation strategies.

The system should have:

- A **React dashboard** to simulate attacks, show Suricata alerts, real-time sensor values, and mitigation guidance  
- A **FastAPI backend** to execute attacks, fetch & process Suricata logs, poll PLC/sensor values, detect behavior anomalies, and store attack/alert data  
- **Suricata IDS** configured to detect OT network anomalies (Modbus, MQTT, DNP3)  
- **Docker + Kubernetes** for deployment, and **Ansible scripts** for automation  

---

### ğŸ“ FILE STRUCTURE (GENERATE FILE-BY-FILE)

OT-Attack-Simulator/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                         â† FastAPI entry point
â”‚   â”œâ”€â”€ config.py                       â† Configurations (DB, Suricata path, scan intervals)
â”‚   â”œâ”€â”€ database.py                     â† DB connection (PostgreSQL or MongoDB)
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ attacks.py                  â† API to trigger attack simulations
â”‚   â”‚   â”œâ”€â”€ suricata_logs.py           â† Fetch Suricata alerts
â”‚   â”‚   â”œâ”€â”€ mitigation.py              â† Provide countermeasure guidance
â”‚   â”‚   â”œâ”€â”€ devices.py                 â† Real-time PLC/sensor data
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ attack_simulator.py        â† Simulate Modbus/MQTT/OPC-UA attacks
â”‚   â”‚   â”œâ”€â”€ suricata_monitor.py        â† Parse Suricata alerts
â”‚   â”‚   â”œâ”€â”€ device_monitor.py          â† Poll sensors/PLCs (Modbus, MQTT)
â”‚   â”‚   â”œâ”€â”€ behavior_analyzer.py       â† Analyze real-time data for behavioral anomalies
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ attack_logs.py             â† Log of attacks triggered
â”‚   â”‚   â”œâ”€â”€ alerts.py                  â† Suricata and anomaly alerts
â”‚   â”‚   â”œâ”€â”€ device_snapshot.py         â† Real-time machinery values
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ network_scanner.py         â† Scan OT network for active PLCs
â”‚   â”œâ”€â”€ Dockerfile                     â† Backend Dockerfile

â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.js           â† Main dashboard view
â”‚   â”‚   â”‚   â”œâ”€â”€ AttackSimulator.js     â† UI to trigger attacks
â”‚   â”‚   â”‚   â”œâ”€â”€ LiveSensors.js         â† Display live PLC/sensor values
â”‚   â”‚   â”‚   â”œâ”€â”€ Alerts.js              â† Suricata and anomaly alerts
â”‚   â”‚   â”‚   â”œâ”€â”€ Mitigation.js          â† Shows suggested fixes
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Logs.js
â”‚   â”‚   â”œâ”€â”€ App.js, api.js             â† Routing and API service
â”‚   â”œâ”€â”€ Dockerfile                     â† Frontend Dockerfile

â”œâ”€â”€ suricata/
â”‚   â”œâ”€â”€ suricata.yaml                  â† Config file with Modbus/MQTT/DNP3 enabled
â”‚   â”œâ”€â”€ rules/ot_attacks.rules         â† Custom Suricata rules for OT attack detection
â”‚   â”œâ”€â”€ logs/                          â† Suricata alert logs (eve.json)

â”œâ”€â”€ deployment/
â”‚   â”œâ”€â”€ docker-compose.yml             â† Run backend, frontend, Suricata
â”‚   â”œâ”€â”€ k8s/                           â† Kubernetes manifests
â”‚   â”‚   â”œâ”€â”€ backend-deployment.yml
â”‚   â”‚   â”œâ”€â”€ frontend-deployment.yml
â”‚   â”‚   â”œâ”€â”€ suricata-deployment.yml
â”‚   â”œâ”€â”€ ansible/
â”‚   â”‚   â”œâ”€â”€ playbook.yml
â”‚   â”‚   â”œâ”€â”€ roles/
â”‚   â”‚   â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â”‚   â”œâ”€â”€ frontend/
â”‚   â”‚   â”‚   â”œâ”€â”€ suricata/

â”œâ”€â”€ .env, .gitignore
â”œâ”€â”€ README.md

---

### ğŸ§  FUNCTIONAL REQUIREMENTS

1. âœ… **Attack Simulation**
   - Simulate Modbus unauthorized writes using `pymodbus`
   - MQTT spoofed publish using `paho-mqtt`
   - Simulate basic DoS or MITM using `scapy`
   - Log attack execution details

2. âœ… **Suricata Integration**
   - Monitor Modbus, DNP3, MQTT protocols
   - Parse Suricataâ€™s `eve.json` and expose alerts via API

3. âœ… **Real-Time Machinery Monitoring**
   - Periodically poll PLCs/sensors using Modbus/MQTT/OPC-UA
   - Store snapshots of device state (temp, pressure, flow, coil status, etc.)
   - Show current values on dashboard (auto-refresh/polling)

4. âœ… **Behavioral Anomaly Detection**
   - Define normal value ranges for each sensor/device
   - If live reading deviates significantly, trigger alert
   - Alert reason: â€œBoiler Overheatâ€, â€œFlow Drop with Motor ONâ€, etc.

5. âœ… **Mitigation Guidance**
   - Based on attack or anomaly type, return step-by-step mitigation instructions
   - E.g., "Block IP at firewall", "Reset PLC", "Check access control settings"

6. âœ… **Frontend Dashboard**
   - Live telemetry panel (sensor values)
   - Attack simulator controls
   - Live alerts panel (Suricata + behavioral)
   - Recommended mitigation section

7. âœ… **Deployment & Automation**
   - Dockerfiles for backend, frontend
   - Compose for local, K8s manifests for production
   - Ansible playbook to auto-deploy all components

---

### âš ï¸ CONSTRAINTS

- All attacks must be **safe simulations** (no real harm, just register overrides/fakes)
- Suricata config must be tuned to OT protocols
- PLC/sensor polling intervals should be configurable
- Frontend should be usable on touchscreen devices (industrial settings)

---
